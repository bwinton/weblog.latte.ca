<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Blog-O! (firefox)</title><link>https://weblog.latte.ca/</link><description></description><atom:link type="application/rss+xml" href="https://weblog.latte.ca/tags/firefox.xml" rel="self"></atom:link><language>en</language><lastBuildDate>Wed, 24 Feb 2016 17:07:41 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Hey!  Let’s Write a WebExtension!</title><link>https://weblog.latte.ca/blake/tech/firefox/webextensiontutorial.html</link><dc:creator>Blake Winton</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;small&gt;(This article is also posted on &lt;a href="https://hacks.mozilla.org/2015/09/lets_write_a_webextension/"&gt;Mozilla
Hacks&lt;/a&gt;.)&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;You might have heard about Mozilla’s &lt;a href="https://wiki.mozilla.org/WebExtensions" title="Mozilla’s WebExtensions Wiki Page"&gt;WebExtensions&lt;/a&gt;, our
implementation of a new browser extension API for writing
multiprocess-compatible add-ons.  Maybe you’ve been wondering what it was about,
and how you could use it. Well, I’m here to help!  I think &lt;a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions" title="MDN’s WebExtensions Documentation"&gt;MDN’s WebExtensions
Docs&lt;/a&gt; have a pretty great definition:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WebExtensions are a new way to write Firefox extensions.&lt;/p&gt;
&lt;p&gt;The technology is developed for cross-browser compatibility: to a large extent
the API is compatible with the &lt;a href="https://developer.chrome.com/extensions" title="Chrome’s Extension API"&gt;extension API&lt;/a&gt; supported by Google
Chrome and Opera. Extensions written for these browsers will in most cases run
in Firefox with just a few changes. The API is also fully compatible with
&lt;a href="https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Multiprocess_Firefox" title="a.k.a. Electrolysis"&gt;multiprocess Firefox&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The only thing I would add is that while Mozilla is implementing most of the API
that Chrome and Opera support, we’re not restricting ourselves to only that API.
Where it makes sense, we will be adding new functionality and talking with other
browser makers about implementing it as well.  Finally, since the WebExtension
API is still under development, it’s probably best if you use &lt;a href="https://nightly.mozilla.org/" title="Download Nightly Here"&gt;Firefox
Nightly&lt;/a&gt; for this tutorial, so that you get the most up-to-date,
standards-compliant behaviour.  But keep in mind, this is still experimental
technology — things might break!&lt;/p&gt;
&lt;h4&gt;Starting off&lt;/h4&gt;
&lt;p&gt;Okay, let’s start with a reasonably simple add-on. We’ll add a button, and when
you click it, it will open up &lt;a href="http://chilloutandwatchsomecatgifs.com/" title="Cat Gifs!"&gt;one of my favourite sites&lt;/a&gt; in a new
tab.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://weblog.latte.ca/blake/tech/firefox/webextensiontutorial.html"&gt;Read more…&lt;/a&gt; (9 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><category>addon</category><category>firefox</category><category>mozilla</category><category>webextension</category><guid>https://weblog.latte.ca/blake/tech/firefox/webextensiontutorial.html</guid><pubDate>Mon, 21 Sep 2015 18:52:00 GMT</pubDate></item><item><title>Cleaning out your Firefox profile.</title><link>https://weblog.latte.ca/blake/employment/mozilla/tabsaver.html</link><dc:creator>Blake Winton</dc:creator><description>&lt;div&gt;&lt;p&gt;For a while now, I’ve been having problems with my Firefox profile.  To be fair,
it’s mostly because of random &lt;a href="about:config"&gt;about:config&lt;/a&gt; tweaks I’ve made, but
still, not being able to test the &lt;a href="https://blog.mozilla.org/blog/2012/11/20/firefox-introduces-new-social-api-and-previews-integration-with-facebook/"&gt;new SocialAPI&lt;/a&gt; stuff was pretty annoying.  So I decided to try &lt;a href="http://support.mozilla.org/en-US/kb/reset-firefox-easily-fix-most-problems"&gt;resetting my profile&lt;/a&gt;,
to clear out all the junk, and hopefully even make it a little faster.&lt;/p&gt;
&lt;p&gt;But, as the page I linked to just up there mentions, resetting your profile will
lose your open tabs, windows and tab groups, which kinda sucks, because I have
57 open tabs, in various groups, and I really don’t want to lose them!
Fortunately, I’m a programmer, so I hacked on Firefox to get it to save and
restore my tabs, and now I’m a happy camper!&lt;/p&gt;
&lt;p&gt;A couple of days later, one of my co-workers had some similar problems, and also
wanted to re-set his profile to try and fix them.  I hadn’t saved the results of
my hacking, so I had to re-create it for him from a combination of memory and
the documentation.  The new code I came up with looked something like this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;gBrowser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;tabs&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"var tabs = [\n"&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;'  "'&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;linkedBrowser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;contentWindow&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;location&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'",\n'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nx"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;'];\nfor (var i = 0; i &amp;lt; tabs.length; i++ ) {\n'&lt;/span&gt;
&lt;span class="nx"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;'  gBrowser.addTab(tabs[i]);\n}\n'&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;To run it, first open &lt;a href="about:config"&gt;about:config&lt;/a&gt;, and make sure the
&lt;code&gt;devtools.chrome.enabled&lt;/code&gt; preference is set to &lt;code&gt;true&lt;/code&gt; (double-click it if it
isn’t, and it should switch automatically), then go to the &lt;code&gt;Tools » Web
Developer » Scratchpad&lt;/code&gt; menu item, which should open up a small new window with
some javascript comments in it.  While that window is focused, click on
&lt;code&gt;Environment » Browser&lt;/code&gt;, to make sure that you’re running the code in the
browser’s chrome (instead of in the page’s content).  Paste the code in, and
click &lt;code&gt;Execute » Display&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;That should result in a bunch of code in grey surrounded by &lt;code&gt;/*&lt;/code&gt; and &lt;code&gt;*/&lt;/code&gt; that
looks like:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;tabs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;span class="s2"&gt;"http://weblog.latte.ca/blake"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s2"&gt;"http://breakingtheegg.tumblr.com/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;tabs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;gBrowser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addTab&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tabs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Copy that out of the scratchpad into your favourite editor, remove the &lt;code&gt;/*&lt;/code&gt; and
&lt;code&gt;*/&lt;/code&gt;, and run the profile reset.&lt;/p&gt;
&lt;p&gt;Once you’re done resetting your profile, you’ll need to change the
&lt;code&gt;devtools.chrome.enabled&lt;/code&gt; preference to &lt;code&gt;true&lt;/code&gt; again, and then re-open the
Scratchpad, paste the new code you saved back in to it, click on the
&lt;code&gt;Execute » Run&lt;/code&gt; menu item, and &lt;strong&gt;shazam&lt;/strong&gt;!  All your tabs should be back
(although they won’t be in their original tab groups.  If anyone needs me to
figure out how to do that, just let me know, and I’ll give it a try).&lt;/p&gt;&lt;/div&gt;</description><category>cleaning</category><category>faster</category><category>firefox</category><category>mozilla</category><category>profile</category><guid>https://weblog.latte.ca/blake/employment/mozilla/tabsaver.html</guid><pubDate>Fri, 23 Nov 2012 18:42:09 GMT</pubDate></item><item><title>A Proposal for Updates with Add-ons.</title><link>https://weblog.latte.ca/blake/tech/thunderbird/updates.html</link><dc:creator>Blake Winton</dc:creator><description>&lt;div&gt;&lt;p&gt;Add-ons are an important part of many Mozilla products, and many people
have noticed that they’ve taken a hit as we’ve switched to the Rapid
Release process.  To help users have a little more control over how well
their Firefox works, I would like to propose the following slight
modification to the automatic Update process:&lt;/p&gt;
&lt;p&gt;It all starts when Firefox (and Thunderbird) notice an update is available.&lt;/p&gt;
&lt;p&gt;We immediately check the user’s add-ons to see if they are compatible, or
if there are compatible versions we haven’t downloaded yet.&lt;/p&gt;
&lt;p&gt;If all the add-ons are compatible (or will be made so at the next
download), we show the NoAddons dialog:&lt;/p&gt;
&lt;p&gt;&lt;img alt="NoAddons dialog" src="https://weblog.latte.ca/images/blake/updates/NoAddons.png"&gt;&lt;/p&gt;
&lt;p&gt;It‘s the same as the current Firefox or Thunderbird update dialog, and as
you would expect, the “Ask Later” and “Update Firefox” buttons do the same
things that they do now.&lt;/p&gt;
&lt;p&gt;On the other hand, if there &lt;em&gt;are&lt;/em&gt; in-compatible add-ons, we show the Addons
dialog:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Addons dialog" src="https://weblog.latte.ca/images/blake/updates/Addons.png"&gt;&lt;/p&gt;
&lt;p&gt;As you can see, we let the user know which add-ons are incompatible, and
give the user an extra button at the bottom to do something different.&lt;/p&gt;
&lt;p&gt;The new “Update when my add-ons work” button (wording to be clarified
later) will check the add-ons periodically, and automatically update
Firefox when all the add-ons are compatible.  If the add-ons aren’t
compatible after a week (period of time to be configurable), the user will
be shown this dialog again, with the (hopefully smaller) list of
incompatible add-ons.&lt;/p&gt;
&lt;p&gt;Showing the user which add-ons are incompatible will let them decide
whether the add-ons are important enough to not upgrade, or whether they
can live with the (hopefully short) period of reduced functionality.&lt;/p&gt;
&lt;p&gt;As always, comments welcome, but keep them polite or they’ll be deleted.&lt;/p&gt;&lt;/div&gt;</description><category>add-ons</category><category>firefox</category><category>mozilla</category><category>thunderbird</category><category>update</category><guid>https://weblog.latte.ca/blake/tech/thunderbird/updates.html</guid><pubDate>Thu, 08 Sep 2011 18:49:44 GMT</pubDate></item><item><title>DOM appendChild error in Gecko 2.0</title><link>https://weblog.latte.ca/blake/tech/thunderbird/appendchild.html</link><dc:creator>Blake Winton</dc:creator><description>&lt;div&gt;&lt;p&gt;I was recently modifying an add-on for the upcoming Thunderbird 3.3, and
part of what I wanted to do was to run some javascript in a chrome context
that added some DOM nodes to a document in a content context.  But when I
ran the following code:&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'tabmail'&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;getBrowserForSelectedTab&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;contentDocument&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"\n\n\n\nXXXXXXXXXX\n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"DOM Content loaded for "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;location&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;"\n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;topBar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"div"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;topBar&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"We got it!!!!!"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"iB = "&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;insertBefore&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;"\n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"fC = "&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;firstChild&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;"\n"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;insertBefore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;topBar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;firstChild&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;I got the following error:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;NS_ENSURE_SUCCESS&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="mh"&gt;0x80530009&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="sr"&gt;/Volumes/Devel/thunderbird/src-central/mozilla/content/base/src/&lt;/span&gt;&lt;span class="n"&gt;nsNodeUtils&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;h&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;304&lt;/span&gt;
&lt;span class="n"&gt;WARNING&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;NS_ENSURE_SUCCESS&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;failed&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="mh"&gt;0x80530009&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="sr"&gt;/Volumes/Devel/thunderbird/src-central/mozilla/content/base/src/&lt;/span&gt;&lt;span class="n"&gt;nsGenericElement&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cpp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;4077&lt;/span&gt;
&lt;span class="o"&gt;--&lt;/span&gt; &lt;span class="n"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;snip&lt;/span&gt;&lt;span class="err"&gt;…&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="s1"&gt;'Operation is not supported'&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="mi"&gt;2152923145&lt;/span&gt;
&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="s1"&gt;'NS_ERROR_DOM_NOT_SUPPORTED_ERR'&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Poking around a little, it seemed like I had reasonable things for the
&lt;tt&gt;insertBefore&lt;/tt&gt; method, the &lt;tt&gt;firstChild&lt;/tt&gt; attribute, and the
&lt;tt&gt;topBar&lt;/tt&gt; variable, and so since it was late, and I couldn't see what
I had done wrong, I went to bed.&lt;/p&gt;
&lt;p&gt;That turned out to be a the best thing for me to do, because this morning
&lt;a href="http://blog.xulforum.org"&gt;Jonathan Protzenko&lt;/a&gt; came to the rescue, saying
(&lt;a href="http://groups.google.com/group/mozilla.dev.extensions/browse_thread/thread/cd6f0f02b6bc60f4#"&gt;in response to a similar problem&lt;/a&gt;
with a Firefox 4.0 beta 7 extension):&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you're modifying some content DOM from chrome code, you need to make
sure the child you're appending was created using the unprivileged
document, not the global document.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;// This is chrome code, this is wrong because the span is now chrome
// and you're trying to insert it into content
myContentNode.appendChild(document.createElement("span"))

// This is right, appending a content node to another content node
myContentNode.appendChild(myContentNode.ownerDocument.createElement("span"))
&lt;/pre&gt;


&lt;p&gt;I've hit this issue at least three times when upgrading stuff for Gecko
2.0. Might be what you're looking for .&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And sure enough, when I changed &lt;tt&gt;var topBar =
document.createElement("div");&lt;/tt&gt; to &lt;tt&gt;var topBar =
doc.createElement("div");&lt;/tt&gt;
, it all started working beautifully.&lt;/p&gt;
&lt;p&gt;Thank you, Jonathan!&lt;/p&gt;&lt;/div&gt;</description><category>firefox</category><category>mozilla</category><category>thunderbird</category><guid>https://weblog.latte.ca/blake/tech/thunderbird/appendchild.html</guid><pubDate>Tue, 30 Nov 2010 15:58:11 GMT</pubDate></item><item><title>Some new toys</title><link>https://weblog.latte.ca/blake/employment/mozilla/somejetpacks.html</link><dc:creator>Blake Winton</dc:creator><description>&lt;div&gt;&lt;p&gt;There have been a couple of things I’ve noticed myself doing over and over
again recently, and because I’m a developer whenever I do something over
and over again, I try to find a way to automate it.&lt;/p&gt;
&lt;p&gt;So I did some playing around with Mozilla’s &lt;a href="https://builder.mozillalabs.com/"&gt;Add-on Builder&lt;/a&gt; and came up with &lt;a href="http://bwinton.latte.ca/Work/jetpacks/"&gt;a couple of Jetpacks&lt;/a&gt; that solved my problems.  Maybe
you’ll find them useful, too.&lt;/p&gt;&lt;/div&gt;</description><category>firefox</category><category>jetpacks</category><category>mozilla</category><category>work</category><guid>https://weblog.latte.ca/blake/employment/mozilla/somejetpacks.html</guid><pubDate>Mon, 06 Sep 2010 21:56:09 GMT</pubDate></item></channel></rss>